source('lib.R')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
BiocManager::install("ChIPseeker")
BiocManager::install("CclusterProfiler")
install.packages("installr")
library(installr)
updateR()
updateR()
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
library(BiocManager)
library(BiocParallel)
library(BiocVersion)
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
BiocManager::install("ChIPseeker")
BiocManager::install("clusterProfiler")
library(ChIPseeker)
library(ChIPpeakAnno)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
library(ChIPseeker)
library(ChIPpeakAnno)
library(org.Hs.eg.db)
library(clusterProfiler)
source('lib.R')
setwd("~/GitHub/hse21_H3K9me3_G4_human")
source('lib.R')
setwd("~/GitHub/hse21_H3K9me3_G4_human/data")
setwd("~/GitHub/hse21_H3K9me3_G4_human/scr")
source('lib.R')
source('lib.R')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
install.packages("Matrix")
install.packages("mgcv")
setwd("~/GitHub/hse21_H3K9me3_G4_human/scr")
source('lib.R')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
library(ChIPseeker)
library(ChIPpeakAnno)
library(org.Hs.eg.db)
library(clusterProfiler)
install.packages("stringi")
library(ChIPseeker)
library(ChIPpeakAnno)
library(org.Hs.eg.db)
library(clusterProfiler)
install.packages("C:/Users/mi/Desktop/stringi_1.6.1.zip", repos = NULL, type = "win.binary")
library(ChIPseeker)
library(ChIPpeakAnno)
library(org.Hs.eg.db)
library(clusterProfiler)
library(stringi)
library(ChIPseeker)
library(ChIPpeakAnno)
library(org.Hs.eg.db)
library(clusterProfiler)
if https:// URLs are not supported
source("https://bioconductor.org/biocLite.R")
biocLite("TxDb.Hsapiens.UCSC.hg19.knownGene")
source("https://bioconductor.org/biocLite.R")
biocLite("TxDb.Hsapiens.UCSC.hg19.knownGene")
###
library(ChIPseeker)
library(ChIPpeakAnno)
library(org.Hs.eg.db)
library(clusterProfiler)
install.packages("C:/Users/mi/Desktop/TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2.tar.gz", repos = NULL, type = "source")
library(ChIPseeker)
library(ChIPpeakAnno)
library(org.Hs.eg.db)
library(clusterProfiler)
NAME <- 'H3K9me3_SK-N-SH.ENCFF709THW.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
source('lib.R')
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
#png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
NAME <- 'H3K9me3_SK-N-SH.ENCFF501EUA.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
#png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
source('lib.R')
NAME <- 'DeepZ'
#NAME <- 'H3K9me3_SK-N-SH.ENCFF501EUA.hg19'
#NAME <- 'H3K9me3_SK-N-SH.ENCFF709THW.hg19'
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
#colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
colnames(bed_df) <- c('chrom', 'start', 'end')
bed_df$len <- bed_df$end - bed_df$start
head(bed_df)
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('filter_peaks.', NAME, '.init.hist.pdf'), path = OUT_DIR)
source('lib.R')
###
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
